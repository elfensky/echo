# Echo Service Documentation

# Release notes // V1.0

This is a service that provides mock API data based on specified templates. The current version has the following features

- Browse through and sort a list of all available templates
- Create a new template by uploading a json file and filling out the metadata.
- View the template and preview the response.
- Edit template keys, values and value types.
- Create and browse through multiple versions of the same template. For example, one has static data that&#39;s always the same, and the other uses dynamic data and shows a random email each time you call it.
- Ability to set &quot;required&quot; keys that must be included using POST when accessing the template.
- An &quot;echo&quot; service that responds with whatever the post body was.

# Project Structure

**/src** contains all the necessary files required for the service to function. Only the files in the _public_ folder should be accessible to the user, all the rest are &quot;behind the curtain&quot; files that are needed but should not be visible.

 Within you will find:

**/css** has a style.css and a style.map.css which are files generated by the SCSS compiler.

**/db** contains the two sqlite database files the project uses.

- **echo.sqlite** contains all the templates and related information
- **random.sqlite** contains various values such as emails and names that are used to populate dynamic values.


**/dependencies** contain 3rd party libraries used in this project

- **/boostrap** has been used for styling, as it&#39;s UI is a common and familiar sight. Bootstrap makes it clear what&#39;s a button and what&#39;s just information.
- **/datatables** is a library used to make html tables dynamic and sortable. This is used on the homepage (_../public/index.php_) to make the list of templates interactive.
- **/fontawesome** has been used for all of the icons on the website.
- **/jquery** contains the minified v3.5.1 of jQuery which is both – required by some of the other dependencies and I myself use throughout the website.

**/img** has the favicon. Right now it&#39;s a placeholder with the logo of the police

**/js** has all the custom javascript I wrote for the website

- **branch.js** is present on _../public/edit.php_ and handles the &quot;create branch&quot; functionality. It gets all of the template information and sends it using ajax to _../php/branch.php_ that uses the post data to create a new branch in _echo.sqlite_. It uses functions and is dependent on _json.js_.
- **clear.js** is only present on the _../public/new.php_page and handles the &quot;clear&quot; button, which is remove the uploaded template and any entered inputs like text.
- **collapse.js** handles showing and hiding nested structures within the template.
- **datatables.js** is present on ../public/index.php and initializes the library.
- **delete.js** is responsible for all of the delete functionality in the app. It handles removing individual versions as well as removing a template completely.
- **json.js** is the most important file, and is what converts the html table to a json format. It has the functions to redraw the preview, and it&#39;s what branch, update and create.js use to get the template data that they sent.
- **update.js** is present on _../public/edit.php_ and handles the &quot;update version&quot; functionality. Just like branch.js, it gets all template data and sents it using ajax to ../php/update.php

**/php** has the &quot;background&quot; php files that handle creating, updating or deleting records from the echo.sqlite database.

- **branch.php** handles creating a new version of a template (a new branch)
- **create.php** handles creating a completely new template
- **delete.php** handles all of the deletions
- **update.php** handles updating an existing version of a template.

**/public** contains the actual pages the user will access

- **index.php** is the homepage. It shows a list of all currently available templates and links to them, has a button to create a new one, and allows filtering the list to find the template that you need
- **new.php** is the page on which you create a new template.
- **view.php** is the view (and preview) of the template. Here you can switch between and view individual versions.
- **edit.php** is where the user will go to edit a template. or create a new branch.
- **echo.php** is the endpoint of the api, from where you can GET or POST specified templates.

**/scss** contains the the actual style and bootstrap overrides.

- **\_components.json.scss** contains the styles needed for syntax highlighting in the preview window, with the rest following the regular scss/sass conventions

# Installation Guide &amp; Requirements

## Installation

Put the contents of the **/src** folder in the root directory of your server, and start it up.
 Open a recent browser like Firefox or Chrome and navigate to \&lt;server\&gt;/public to start using the service.

## Requirements:

- PHP 7.4.2
- ECMAScript 6
- HTML5

## Database structure

![](RackMultipart20200623-4-1utcue4_html_cb95d788c4702517.png)[https://dbdiagram.io/d/5ef15b649ea313663b3aeb3c](https://dbdiagram.io/d/5ef15b649ea313663b3aeb3c)

template\_info contains the &quot;general&quot; information used to populate the list on the index.php page.

template\_data contains the actual versions and its primary key is what&#39;s used to specify the template when using echo.php

department has all the different departments, and templates\_departments is the in-beteen table that contains the information about which templates belong to what departments.

# User Guide

## Homepage // index.php

![](RackMultipart20200623-4-1utcue4_html_8e33b444b606f636.png)

This is the homepage. It has a filter so you can browse the list by template name or author name. You can set the amount of rows you want to display per page or click the button to create a new template.

Clicking on the name of a template (2nd column) will take you to view.php where you can see the template&#39;s details.

## Create template // new.php

![](RackMultipart20200623-4-1utcue4_html_a5733bcb0e277e29.png)

To create a template you must first upload the template.json file. The service will process it and display it and a preview in the corresponding windows.

If needed, you can then edit the keys, values and their types. If you need to change the structure however, such as adding or removing rows, you will need to use the clear button and reupload a new file.

![](RackMultipart20200623-4-1utcue4_html_5780f20ef1d60a66.png) ![](RackMultipart20200623-4-1utcue4_html_ca16d539eba2c479.png)

After you are sure the template is correct you can fill out the metadata and press the create button. This will create the needed records in the SQLite database and take you to the view.php page to show you the template.

![](RackMultipart20200623-4-1utcue4_html_1e02718845dd95cd.png)

## View template // view.php

![](RackMultipart20200623-4-1utcue4_html_2d1594a7b3ba014f.png)

You can view an existing template by selecting it from the list on the homepage. You are shown the template&#39;s structure as well as the ULR to access it as an API with a preview of the response on the right.

From here you can use the dropdown to browse and view other versions based on this template, edit it, or delete the currently version.

C ![](RackMultipart20200623-4-1utcue4_html_b07961760f70b93b.png) ertain keys can be set as required, which means that the value is a placeholder, and you will need to overwrite it when accessing it through the API endpoint using a POST request with the required keys and value pairs.

Using the [[value]] syntax you can also set dynamic variables that will provide random data when used through the API

![](RackMultipart20200623-4-1utcue4_html_9f8732ad9505c21b.png)

In this example, you will need to POST {&quot;token&quot;:&quot;value&quot;} and the &quot;fdass&quot; key will have a random email each time you call it.

## Edit template // edit.php

![](RackMultipart20200623-4-1utcue4_html_35d948b1e7db93db.png)

It&#39;s fairly self-explanatory, but you can the metadata of the template as well as its edit keys as well as their values and types.
 Editing the template structure is currently unsupported, and you will need to create a completely new template by uploading a new json file with changed structure to do it.

You can branch off to create a new version, or update the current one.

## Echo.php // the api endpoint

No user interface, see POSTMAN examples.

[https://www.getpostman.com/collections/cd2f0d1760819c0545c3](https://www.getpostman.com/collections/cd2f0d1760819c0545c3)

This is the api endpoint where you can get the actual responses that you would use for testing your application.

If you do not specify any template using get, you can use POST to get an echo of its contents.

If the template has no required keys, it can simply be accessed using a get, when specifying it&#39;s primary key. Otherwise, you will need to POST the required key value pairs using raw/JSON in the { &quot;key&quot;:&quot;value&quot;,&quot;key2&quot;:&quot;value2&quot;,…} format.

# Known bugs &amp; issues

- If you delete the last &quot;version&quot; of a template, it will still show up in the template list, but the view.php will simply not load. You can delete that part from the homepage.
 Proposed fix: check how many versions exist, and if there&#39;s only one perform a complete delete instead of the partial one.
- If you fill out the metadata prior to uploading a file, it will be lost once it&#39;s uploaded and you will have to re-enter it.
 Proposed fix: submit the entered metadata together with the file and process it into the corresponding fields.

- Nested arrays cause the json generator in json.js to fail. I have not been able to figure out why. The php processes and displays them fine, but you won&#39;t be able to save them. A temporary workaround is manually editing the template field in the SQLite database using SQLite Studio, but, again, you won&#39;t be able to make use of the edit functionality until this issue is fixed